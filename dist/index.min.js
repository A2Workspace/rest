"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=t(require("axios"));function e(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}function o(){return o=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},o.apply(this,arguments)}function i(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,a(t,r)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function a(t,r){return a=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t},a(t,r)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function s(t,r,e){return s=c()?Reflect.construct:function(t,r,e){var n=[null];n.push.apply(n,r);var o=new(Function.bind.apply(t,n));return e&&a(o,e.prototype),o},s.apply(null,arguments)}function f(t){var r="function"==typeof Map?new Map:void 0;return f=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,n)}function n(){return s(t,arguments,u(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)},f(t)}var p=0;function l(t){return"__private_"+p+++"_"+t}function h(t,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw new TypeError("attempted to use private field on non-instance");return t}var v={method:"",url:"",data:{},params:{}};function d(t,r){t=y(t),r=y(r);for(var e={},n=0,o=Object.entries(v);n<o.length;n++){var i=o[n],u=i[0],a=i[1];b(a)?e[u]=g(a,t[u],r[u]):e[u]=r[u]||t[u]||a}return e}function y(t){return b(t)?t:{}}function b(t){return"object"==typeof t&&null!==t}function g(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return Object.assign.apply(Object,[{}].concat(r.filter(b)))}function O(t,r){var e=Array.isArray(t)?t:[t];return function(t){var n,o=null==(n=t.response)?void 0:n.status;if(o&&e.includes(o))return r(t);throw t}}var m=function(){function t(t){this._response=void 0,this._message=void 0,this._errors=void 0,this._response=t,this._message=t.data.message||"The given data was invalid",this._errors=t.data.errors||{};for(var r=0,e=Object.entries(this._errors);r<e.length;r++){var n=e[r],o=n[0],i=n[1];this._errors[o]=Array.isArray(i)?i:[i]}}return t.prototype.first=function(t){for(var r=0,e=Object.entries(this._errors);r<e.length;r++){var n=e[r],o=n[0],i=n[1];if(!t||t==o)return i[0]}},n(t,[{key:"response",get:function(){return this._response}},{key:"message",get:function(){return this._message}},{key:"errors",get:function(){return this._errors}}]),t}(),_=function(t){function r(r){var e;e=t.call(this,r)||this;for(var n=0,o=Object.entries(e._errors);n<o.length;n++){var i=o[n],u=i[0],a=i[1];e._errors[u]=a[0]}return e}return i(r,t),r.prototype.first=function(t){for(var r=0,e=Object.entries(this._errors);r<e.length;r++){var n=e[r],o=n[0],i=n[1];if(!t||t==o)return i}},n(r,[{key:"errors",get:function(){return this._errors}}]),r}(m),w=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var e=r.prototype;return e.catchAxiosError=function(t){return this.catch(function(t){return function(r){if(r.isAxiosError)return t(r);throw r}}(t))},e.catchStatusCode=function(t,r){return this.catch(O(t,r))},e.catchValidationError=function(t,r){return this.catch(function(t,r){return"function"==typeof t&&(r=t,t=!1),O(422,(function(e){if("function"!=typeof r)return null;var n=t?new _(e.response):new m(e.response);return r(n)}))}(t,r))},r}(f(Promise));w.wrap=function(t){if(t instanceof Promise)return w.resolve(t);throw TypeError("傳入的參數必須為 Promise")};var j=l("resourceURN"),A=l("options"),x=l("axios"),P=function(){function t(t,e){var n;void 0===e&&(e={}),Object.defineProperty(this,j,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:void 0}),h(this,j)[j]=String(t).replace(/\/$/,""),h(this,x)[x]=e.axios||r.default,h(this,A)[A]=e,(n=this).bindAction("fetchAll",(function(t){return void 0===t&&(t={}),"function"==typeof t&&(t=t(this.lastQuery.params)),"object"!=typeof t&&(t={}),{params:t}})),n.bindAction("create",(function(t){return void 0===t&&(t={}),{data:t}})),n.bindAction("fetch",(function(t,r){return void 0===r&&(r={}),{params:r,parseURL:function(r){return r+"/"+t}}})),n.bindAction("update",(function(t,r){return void 0===r&&(r={}),{data:r,parseURL:function(r){return r+"/"+t}}})),n.bindAction("delete",(function(t,r){return void 0===r&&(r={}),{params:r,parseURL:function(r){return r+"/"+t}}}))}return t.prototype.bindAction=function(t,r){var e=this;if(void 0!==this[t])throw new Error(t+" 已存在");var n=h(this,A)[A][t],o=function t(){for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];var a=r.call.apply(r,[t].concat(i)),c=d(n,a);return c.url=R(a,h(e,j)[j]),t.lastQuery=c,w.wrap(h(e,x)[x].request(c))};o.options=n,o.lastQuery={},this[t]=o},t}();function R(t,r){return"function"==typeof t.parseURL?t.parseURL(r):r}var E={axios:r.default,fetchAll:{method:"get",params:{}},create:{method:"post",data:{}},fetch:{method:"get",params:{}},update:{method:"put",data:{}},delete:{method:"delete",data:{}}},k=["axios"];function S(t,r){return void 0===r&&(r={}),new P(t,o({},o({},U(function(t){t.axios;var r=function(t,r){if(null==t)return{};var e,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)e=i[n],r.indexOf(e)>=0||(o[e]=t[e]);return o}(t,k);return r}(e=S.defaults)),{axios:e.axios}),U(r)));var e}function U(t){return JSON.parse(JSON.stringify(t))}S.defaults=E,module.exports=S;
